
%h2= @title

=render 'tabs'

%table.dataTable.display.responsive.nowrap
  %thead
    %tr
      %th Id
      %th Name
      %th Exists?
      %th Private?
      %th Accesses
      %th Saves
      -unless @user
        %th Owner
      %th Storage key
      %th Size (MB)
      %th.default-sort Last access
      %th Last update
      %th Created
  %tbody
    -@sites.each do |s|
      %tr
        =datatable_sort_by(s.id)
        %td
          -if s.is_private?
            -# Admin will be able to see it, but make it harder to
            -# click as a reminder that this is a private site
            =s.name
            =site_link(s, link_title: '!')
          -elsif s.exists?
            =site_link(s)
          -else
            =s.name
            =site_link(s, link_title: '&times;'.html_safe)
        %td= bool_text s.exists?
        %td= bool_text s.is_private?
        =datatable_sort_by(s.access_count)
        =datatable_sort_by(s.save_count)
        -unless @user
          %td= link_to_user_sites(s.user_email, s.user) if s.user
        %td= s.blob_key
        -if s.blob.present?
          =datatable_sort_by(s.blob_byte_size, as_megabytes(s.blob_byte_size))
        -else
          =datatable_sort_by(0, '-')
        =datatable_timestamp(s.accessed_at)
        =datatable_timestamp(s.blob_created_at)
        =datatable_timestamp(s.created_at)
